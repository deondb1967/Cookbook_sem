<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Dealing with missing data – Structural equation modeling with lavaan in R: Examples and excercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./summary.html" rel="next">
<link href="./Correlated_residuals.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./MissingDataExamples.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Dealing with missing data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Structural equation modeling with lavaan in R: Examples and excercises</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ReadingStoringData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reading and storing data in <em>R</em></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DataManagement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data management in <em>R</em></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Subsetting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Subsetting a data frame</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Part I: Measurement model</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Spearman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Single factor model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Multiple_factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Multiple factors</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Part II: Diagnosing and improving the measurement model</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Modification_indices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Modification Indices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EFA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exploratory factor analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Correlated_residuals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Correlated residuals</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Part III: Structural model</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MissingDataExamples.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Dealing with missing data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#r-packages-used-in-the-demonstration" id="toc-r-packages-used-in-the-demonstration" class="nav-link active" data-scroll-target="#r-packages-used-in-the-demonstration"><span class="header-section-number">10.1</span> <em>R</em> packages used in the demonstration</a></li>
  <li><a href="#cfa-of-the-5-item-neuroticism-scale-of-the-big-five-inventory" id="toc-cfa-of-the-5-item-neuroticism-scale-of-the-big-five-inventory" class="nav-link" data-scroll-target="#cfa-of-the-5-item-neuroticism-scale-of-the-big-five-inventory"><span class="header-section-number">10.2</span> CFA of the 5-item Neuroticism scale of the Big Five Inventory</a></li>
  <li><a href="#examining-patterns-of-missing-data-and-testing-for-missing-completely-at-random" id="toc-examining-patterns-of-missing-data-and-testing-for-missing-completely-at-random" class="nav-link" data-scroll-target="#examining-patterns-of-missing-data-and-testing-for-missing-completely-at-random"><span class="header-section-number">10.3</span> Examining patterns of missing data and testing for “missing completely at random”</a></li>
  <li><a href="#full-information-maximum-likelihood-estimation" id="toc-full-information-maximum-likelihood-estimation" class="nav-link" data-scroll-target="#full-information-maximum-likelihood-estimation"><span class="header-section-number">10.4</span> Full information maximum likelihood estimation</a></li>
  <li><a href="#multiple-imputation-with-the-amelia-and-lavaan.mi-packages" id="toc-multiple-imputation-with-the-amelia-and-lavaan.mi-packages" class="nav-link" data-scroll-target="#multiple-imputation-with-the-amelia-and-lavaan.mi-packages"><span class="header-section-number">10.5</span> Multiple imputation with the Amelia and lavaan.mi packages</a>
  <ul class="collapse">
  <li><a href="#fit-the-model-to-the-imputed-data-sets-and-pool-the-results" id="toc-fit-the-model-to-the-imputed-data-sets-and-pool-the-results" class="nav-link" data-scroll-target="#fit-the-model-to-the-imputed-data-sets-and-pool-the-results"><span class="header-section-number">10.5.1</span> Fit the model to the imputed data sets and pool the results</a></li>
  </ul></li>
  <li><a href="#multiple-imputation-with-ordinal-variables" id="toc-multiple-imputation-with-ordinal-variables" class="nav-link" data-scroll-target="#multiple-imputation-with-ordinal-variables"><span class="header-section-number">10.6</span> Multiple imputation with ordinal variables</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Dealing with missing data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Identifying potential influential cases</p>
<p>Data sets often contain outliers and influential cases. A case is influential if its inclusion in the data set significantly alters the parameters of interest (for instance a factor loading or the correlations between factors). Cook’s <em>d</em> statistic is often used in to identify inluential cases when data are analysed with univariate multiple regression. This can be extended to the multivariate case. The expected influence value is the number of manifest cases divided by the number of participants. Each person’s influence value can be compared to this expected value. In practice, the plot is most useful to identify people whose observed influence values are clearly different from those of the remaining people. The <strong><code>bollen_plot()</code></strong> function of the <strong><code>hemp</code></strong> package can be used to plot each person’s influence statistic. The horizontal line on the plot represents the expected value. If a critical value is supplied, the row numbers of cases that exceed the critical value are printed. Once such influential cases have been identified their observed data can be inspected to identify potential data entering errors or unusual response patterns. The analyst may choose to correct the incorrectly entered data points or perhaps to remove cases with response patterns. Data should be analysed with and without the influential cases and the results compared.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MissingDataExamples_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This chapter contains a simple demonstration of how researchers can deal with missing data in a test construction context using the <code>lavaan</code> and <code>lavaan.mi</code> packages in <em>R</em>. We demonstrate the following:</p>
<ul>
<li><p>identifying <strong>missing data patterns</strong>,</p></li>
<li><p>performing <strong>Little’s MCAR test</strong> (missing completely at random),</p></li>
<li><p>using <strong>full information maximum likelihood</strong> <strong>(“fiml”)</strong> to estimate parameters in the presence of missing data, and</p></li>
<li><p>using <strong>multiple imputation</strong> to estimate parameters in the presence of missing data</p></li>
</ul>
<p>We don’t address the philosophy, pitfalls, or merits of different methods of dealing with missing data, nor do we discuss the different methods of multiple imputation and pooling of results. We just show how a researcher can easily deal with missing data if they have made the decision to do so using either “fiml” or multiple imputation with the defaults of the relevant packages.</p>
<p>Mikko Rönkkö made nice videos about missing data and how to deal with it. He discusses different missing data mechanisms here: <a href="https://www.youtube.com/watch?v=TxcLeMsZ7Bk"><strong>https://www.youtube.com/watch?v=TxcLeMsZ7Bk</strong></a>. He discusses full information maximum likelihood estimation here: <a href="https://www.youtube.com/watch?v=6CQ526G8rOk"><strong>https://www.youtube.com/watch?v=6CQ526G8rOk</strong></a>. Finally, he discusses multiple imputation here: <a href="https://www.youtube.com/watch?v=gQkd_MylHQ8"><strong>https://www.youtube.com/watch?v=gQkd_MylHQ8</strong></a>.</p>
<section id="r-packages-used-in-the-demonstration" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="r-packages-used-in-the-demonstration"><span class="header-section-number">10.1</span> <em>R</em> packages used in the demonstration</h2>
<p>We use the following packages: <code>psychTools</code> (to access the <code>bfi</code> data set), <code>mice</code> (to detect the patterns of missing data), <code>naniar</code> (to perform Little’s MCAR test) , <code>Amelia</code> (to perform the multiple imputation), <code>lavaan</code> (to perform the confirmatory factor analysis), and <code>lavaan.mi</code> (to perform the confirmatory factor analysis with multiple complete data sets).</p>
<p>These packages need to be installed once. To install the packages you need to remove the # at the beginning of each row (<em>R</em> does not evaluate any code that follows a #).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("psychTools")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("naniar")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("lavaan")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("mice")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("Amelia")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>lavaan.mi</code> package is not yet available from the CRAN repository, but it can be downloaded and installed from Terence Jorgenson’s github page. For this you will also need the <code>remotes</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("remotes")</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("TDJorgensen/lavaan.mi")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cfa-of-the-5-item-neuroticism-scale-of-the-big-five-inventory" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="cfa-of-the-5-item-neuroticism-scale-of-the-big-five-inventory"><span class="header-section-number">10.2</span> CFA of the 5-item Neuroticism scale of the Big Five Inventory</h2>
<p>I performed a confirmatory factor analysis of the Neuroticism scale of the Big Five Inventory. The data are in the <code>bfi</code> data frame, which can be found in the <code>psychTools</code> package. There were 2800 participants, but there were only 2694 complete cases. For convenience, I stored the five Neuroticism items (which are in columns 16 to 20 of the <code>bfi</code> data frame) in a new data frame called <code>Ndata</code>.</p>
<p>In this baseline analysis I ignored the missing data. By default, lavaan employs <strong>listwise deletion</strong> when missing data are encountered. At the top of the output it can be seen that the number of observed (<em>n</em> = 2800) and used (<em>n</em> = 2694) cases differ.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychTools)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan.mi)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>Ndata <span class="ot">&lt;-</span> bfi[<span class="dv">16</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>Nmodel  <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">Nfactor =~ N1 + N2 + N3 + N4 + N5</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>fit.Nmodel <span class="ot">&lt;-</span> <span class="fu">cfa</span>(Nmodel, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data      =</span> Ndata, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.Nmodel,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 26 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        10

                                                  Used       Total
  Number of observations                          2694        2800

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               360.932     313.521
  Degrees of freedom                                 5           5
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  1.151
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              4724.621    3492.154
  Degrees of freedom                                10          10
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.353

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.925       0.911
  Tucker-Lewis Index (TLI)                       0.849       0.823
                                                                  
  Robust Comparative Fit Index (CFI)                         0.925
  Robust Tucker-Lewis Index (TLI)                            0.849

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -23078.504  -23078.504
  Scaling correction factor                                  1.007
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -22898.038  -22898.038
  Scaling correction factor                                  1.055
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               46177.007   46177.007
  Bayesian (BIC)                             46235.995   46235.995
  Sample-size adjusted Bayesian (SABIC)      46204.222   46204.222

Root Mean Square Error of Approximation:

  RMSEA                                          0.163       0.151
  90 Percent confidence interval - lower         0.149       0.138
  90 Percent confidence interval - upper         0.177       0.165
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000
                                                                  
  Robust RMSEA                                               0.162
  90 Percent confidence interval - lower                     0.147
  90 Percent confidence interval - upper                     0.178
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.056       0.056

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Nfactor =~                                                            
    N1                1.000                               1.286    0.818
    N2                0.952    0.017   54.734    0.000    1.225    0.803
    N3                0.892    0.028   31.540    0.000    1.147    0.717
    N4                0.677    0.030   22.224    0.000    0.872    0.554
    N5                0.632    0.030   21.255    0.000    0.813    0.502

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .N1                0.819    0.048   16.954    0.000    0.819    0.331
   .N2                0.828    0.046   18.124    0.000    0.828    0.356
   .N3                1.245    0.052   23.807    0.000    1.245    0.486
   .N4                1.714    0.055   31.118    0.000    1.714    0.693
   .N5                1.968    0.057   34.381    0.000    1.968    0.748
    Nfactor           1.655    0.065   25.460    0.000    1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="examining-patterns-of-missing-data-and-testing-for-missing-completely-at-random" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="examining-patterns-of-missing-data-and-testing-for-missing-completely-at-random"><span class="header-section-number">10.3</span> Examining patterns of missing data and testing for “missing completely at random”</h2>
<p>Next, I employed the <code>md.pattern()</code> function of the <code>mice</code> package to identify the patterns of missing data. I also used the <code>mcar_test()</code> function of the <code>naniar</code> package to perform Little’s missing completely at random (MCAR) test. There were 11 missing data patterns. There were 11 missing values for item N3, 21 for item N2, 22 for item N1, 29 for item N5, and 36 for item N4, which gives a total of 119 missing values. The pattern with the most missing values contained three missing values (four persons produced this pattern).</p>
<p>Little’s MCAR test showed that the null hypothesis that the missing data are completely at random could not be rejected: <span class="math inline">\(\chi^2(34) = 27.2, p = 0.791\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">md.pattern</span>(Ndata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MissingDataExamples_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     N3 N2 N1 N5 N4    
2694  1  1  1  1  1   0
32    1  1  1  1  0   1
22    1  1  1  0  1   1
15    1  1  0  1  1   1
2     1  1  0  0  1   2
4     1  1  0  0  0   3
19    1  0  1  1  1   1
1     1  0  1  0  1   2
9     0  1  1  1  1   1
1     0  1  0  1  1   2
1     0  0  1  1  1   2
     11 21 22 29 36 119</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcar_test</span>(Ndata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic    df p.value missing.patterns
      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;            &lt;int&gt;
1      27.2    34   0.791               11</code></pre>
</div>
</div>
</section>
<section id="full-information-maximum-likelihood-estimation" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="full-information-maximum-likelihood-estimation"><span class="header-section-number">10.4</span> Full information maximum likelihood estimation</h2>
<p>Second, I estimated the parameters of the confirmatory factor analysis model using full information maximum likelihood (“fiml”). This approach uses all the available information in the data set to estimate the parameters. It does not estimate what the missing values would be and it does not fill it in to complete the data set. Note that all 2800 cases were now used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fit.Nmodel.fiml <span class="ot">&lt;-</span> <span class="fu">cfa</span>(Nmodel,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data      =</span> Ndata, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">estimator =</span> <span class="st">"MLR"</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">missing   =</span> <span class="st">"fiml"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fixed.x   =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.Nmodel.fiml,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardized =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 30 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        15

  Number of observations                          2800
  Number of missing patterns                        11

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               372.501     322.671
  Degrees of freedom                                 5           5
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  1.154
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              4874.228    3604.773
  Degrees of freedom                                10          10
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.352

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.924       0.912
  Tucker-Lewis Index (TLI)                       0.849       0.823
                                                                  
  Robust Comparative Fit Index (CFI)                         0.924
  Robust Tucker-Lewis Index (TLI)                            0.848

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -23768.675  -23768.675
  Scaling correction factor                                  1.004
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -23582.425  -23582.425
  Scaling correction factor                                  1.041
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               47567.350   47567.350
  Bayesian (BIC)                             47656.411   47656.411
  Sample-size adjusted Bayesian (SABIC)      47608.751   47608.751

Root Mean Square Error of Approximation:

  RMSEA                                          0.162       0.151
  90 Percent confidence interval - lower         0.148       0.138
  90 Percent confidence interval - upper         0.176       0.164
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000
                                                                  
  Robust RMSEA                                               0.163
  90 Percent confidence interval - lower                     0.148
  90 Percent confidence interval - upper                     0.179
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.049       0.049

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Nfactor =~                                                            
    N1                1.000                               1.284    0.818
    N2                0.956    0.017   55.605    0.000    1.227    0.804
    N3                0.896    0.028   32.194    0.000    1.151    0.718
    N4                0.677    0.030   22.550    0.000    0.869    0.554
    N5                0.632    0.029   21.614    0.000    0.811    0.501

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .N1                2.932    0.030   98.558    0.000    2.932    1.867
   .N2                3.508    0.029  121.478    0.000    3.508    2.300
   .N3                3.217    0.030  106.137    0.000    3.217    2.008
   .N4                3.185    0.030  106.886    0.000    3.185    2.030
   .N5                2.969    0.031   96.676    0.000    2.969    1.834

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .N1                0.818    0.047   17.284    0.000    0.818    0.331
   .N2                0.821    0.045   18.271    0.000    0.821    0.353
   .N3                1.242    0.051   24.204    0.000    1.242    0.484
   .N4                1.707    0.054   31.557    0.000    1.707    0.693
   .N5                1.962    0.056   34.977    0.000    1.962    0.749
    Nfactor           1.649    0.064   25.915    0.000    1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="multiple-imputation-with-the-amelia-and-lavaan.mi-packages" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="multiple-imputation-with-the-amelia-and-lavaan.mi-packages"><span class="header-section-number">10.5</span> Multiple imputation with the Amelia and lavaan.mi packages</h2>
<p>Next, I used the <code>Amelia</code> and <code>lavaan.mi</code> packages to (a) perform multiple imputation to obtain 20 data sets that contain plausible estimates of the missing values, (b) fit the confirmatory factor analysis model to each of the data sets, and (c) report the pooled results.</p>
<p>The 20 complete data sets were stored as a list in an object I labeled <code>Ndata.mi</code>. I stored this list in a new object I labeled <code>imps</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Amelia)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan.mi)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Ndata.mi      <span class="ot">&lt;-</span> <span class="fu">amelia</span>(Ndata, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">m =</span> <span class="dv">20</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>imps          <span class="ot">&lt;-</span> Ndata.mi<span class="sc">$</span>imputations</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="fit-the-model-to-the-imputed-data-sets-and-pool-the-results" class="level3" data-number="10.5.1">
<h3 data-number="10.5.1" class="anchored" data-anchor-id="fit-the-model-to-the-imputed-data-sets-and-pool-the-results"><span class="header-section-number">10.5.1</span> Fit the model to the imputed data sets and pool the results</h3>
<p>I fitted the confirmatory factor analysis model to the imputed data sets in <code>imps</code> using the <code>cfa.mi()</code> function of the <code>lavaan.mi</code> package. The results are stored in <code>fit.Nmodel.mi</code>. We access the results by asking for a summary. Note that the parameter estimates are very similar to those obtained with listwise deletion and full information maximum likelihood estimation. Also, the standard errors of the parameters are very similar across the three analyses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fit.Nmodel.mi <span class="ot">&lt;-</span> <span class="fu">cfa.mi</span>(Nmodel, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data      =</span> imps,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.Nmodel.mi, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan.mi object fit to 20 imputed data sets using:
 - lavaan    (0.6-19)
 - lavaan.mi (0.1-0.0030)
See class?lavaan.mi help page for available methods. 

Convergence information:
The model converged on 20 imputed data sets.
Standard errors were available for all imputations.

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        10

  Number of observations                          2800

Model Test User Model:

                                                    Standard      Scaled
  Test statistic                                     375.374     326.698
  Degrees of freedom                                       5           5
  P-value                                              0.000       0.000
  Average scaling correction factor                                1.149
  Pooling method                                          D4            
    Pooled statistic                              "standard"            
    "yuan.bentler.mplus" correction applied            AFTER     pooling

Model Test Baseline Model:

  Test statistic                              4849.800    3598.394
  Degrees of freedom                                10          10
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.348

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.923       0.910
  Tucker-Lewis Index (TLI)                       0.847       0.821
                                                                  
  Robust Comparative Fit Index (CFI)                         0.924
  Robust Tucker-Lewis Index (TLI)                            0.847

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -23961.856  -23961.856
  Scaling correction factor                                  1.005
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -23770.632  -23770.632
  Scaling correction factor                                  1.054
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               47943.711   47943.711
  Bayesian (BIC)                             48003.085   48003.085
  Sample-size adjusted Bayesian (SABIC)      47971.312   47971.312

Root Mean Square Error of Approximation:

  RMSEA                                          0.163       0.152
  90 Percent confidence interval - lower         0.149       0.139
  90 Percent confidence interval - upper         0.177       0.165
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000
                                                                  
  Robust RMSEA                                               0.162
  90 Percent confidence interval - lower                     0.148
  90 Percent confidence interval - upper                     0.178
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.057       0.057

Parameter Estimates:

  Standard errors                                    Sandwich
  Information bread                                  Observed
  Observed information based on                       Hessian
                                                             
  Pooled across imputations              Rubin's (1987) rules
  Augment within-imputation variance     Scale by average RIV
  Wald test for pooled parameters          t(df) distribution

  Pooled t statistics with df &gt;= 1000 are displayed with
  df = Inf(inity) to save space. Although the t distribution
  with large df closely approximates a standard normal
  distribution, exact df for reporting these t tests can be
  obtained from parameterEstimates.mi() 


Latent Variables:
                   Estimate  Std.Err  t-value       df  P(&gt;|t|)   Std.lv
  Nfactor =~                                                            
    N1                1.000                                        1.285
    N2                0.955    0.017   55.650      Inf    0.000    1.227
    N3                0.896    0.028   32.023      Inf    0.000    1.151
    N4                0.677    0.030   22.524      Inf    0.000    0.870
    N5                0.631    0.029   21.570      Inf    0.000    0.811
  Std.all
         
    0.818
    0.804
    0.719
    0.554
    0.501

Variances:
                   Estimate  Std.Err  t-value       df  P(&gt;|t|)   Std.lv
   .N1                0.818    0.047   17.270      Inf    0.000    0.818
   .N2                0.821    0.045   18.257      Inf    0.000    0.821
   .N3                1.239    0.051   24.060      Inf    0.000    1.239
   .N4                1.707    0.054   31.524      Inf    0.000    1.707
   .N5                1.961    0.056   34.947      Inf    0.000    1.961
    Nfactor           1.650    0.064   25.835      Inf    0.000    1.000
  Std.all
    0.331
    0.353
    0.483
    0.693
    0.749
    1.000</code></pre>
</div>
</div>
</section>
</section>
<section id="multiple-imputation-with-ordinal-variables" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="multiple-imputation-with-ordinal-variables"><span class="header-section-number">10.6</span> Multiple imputation with ordinal variables</h2>
<p>The items of the Neuroticism scale are strictly ordinal with six ordered categories. The observed values should be 1, 2, 3, 4, 5 or 6. If we don’t instruct <code>amelia()</code> to treat the items as ordinal, the function will treat them as continuous variables and the imputed values will contain decimals (which is not what we want). The imputed values may even extend beyond the range of the original six-point rating scale (which is really not what we want). Here I impute the missing data with the <code>amelia()</code> function, but now with the added argument that the items are ordinal. The imputed values will now be integers rather than decimals, which is what we want. The results are almost indistinguishable from the previous results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Amelia)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan.mi)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>Ndata.mi2      <span class="ot">&lt;-</span> <span class="fu">amelia</span>(Ndata, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">m    =</span> <span class="dv">20</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ords =</span> <span class="fu">c</span>(<span class="st">"N1"</span>, <span class="st">"N2"</span>, <span class="st">"N3"</span>, <span class="st">"N4"</span>, <span class="st">"N5"</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>imps2          <span class="ot">&lt;-</span> Ndata.mi2<span class="sc">$</span>imputations</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit.Nmodel.mi2 <span class="ot">&lt;-</span> <span class="fu">cfa.mi</span>(Nmodel, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data      =</span> imps2,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">estimator =</span> <span class="st">"MLR"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.Nmodel.mi2, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan.mi object fit to 20 imputed data sets using:
 - lavaan    (0.6-19)
 - lavaan.mi (0.1-0.0030)
See class?lavaan.mi help page for available methods. 

Convergence information:
The model converged on 20 imputed data sets.
Standard errors were available for all imputations.

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        10

  Number of observations                          2800

Model Test User Model:

                                                    Standard      Scaled
  Test statistic                                     363.290     315.881
  Degrees of freedom                                       5           5
  P-value                                              0.000       0.000
  Average scaling correction factor                                1.150
  Pooling method                                          D4            
    Pooled statistic                              "standard"            
    "yuan.bentler.mplus" correction applied            AFTER     pooling

Model Test Baseline Model:

  Test statistic                              4776.413    3547.745
  Degrees of freedom                                10          10
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.346

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.925       0.912
  Tucker-Lewis Index (TLI)                       0.850       0.824
                                                                  
  Robust Comparative Fit Index (CFI)                         0.925
  Robust Tucker-Lewis Index (TLI)                            0.850

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -23982.925  -23982.925
  Scaling correction factor                                  1.003
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -23795.906  -23795.906
  Scaling correction factor                                  1.052
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               47985.849   47985.849
  Bayesian (BIC)                             48045.223   48045.223
  Sample-size adjusted Bayesian (SABIC)      48013.449   48013.449

Root Mean Square Error of Approximation:

  RMSEA                                          0.160       0.149
  90 Percent confidence interval - lower         0.146       0.136
  90 Percent confidence interval - upper         0.174       0.162
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000
                                                                  
  Robust RMSEA                                               0.160
  90 Percent confidence interval - lower                     0.145
  90 Percent confidence interval - upper                     0.175
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.057       0.057

Parameter Estimates:

  Standard errors                                    Sandwich
  Information bread                                  Observed
  Observed information based on                       Hessian
                                                             
  Pooled across imputations              Rubin's (1987) rules
  Augment within-imputation variance     Scale by average RIV
  Wald test for pooled parameters          t(df) distribution

  Pooled t statistics with df &gt;= 1000 are displayed with
  df = Inf(inity) to save space. Although the t distribution
  with large df closely approximates a standard normal
  distribution, exact df for reporting these t tests can be
  obtained from parameterEstimates.mi() 


Latent Variables:
                   Estimate  Std.Err  t-value       df  P(&gt;|t|)   Std.lv
  Nfactor =~                                                            
    N1                1.000                                        1.284
    N2                0.955    0.017   55.326      Inf    0.000    1.226
    N3                0.896    0.028   32.064      Inf    0.000    1.151
    N4                0.678    0.030   22.568      Inf    0.000    0.870
    N5                0.631    0.029   21.614      Inf    0.000    0.810
  Std.all
         
    0.817
    0.803
    0.718
    0.554
    0.501

Variances:
                   Estimate  Std.Err  t-value       df  P(&gt;|t|)   Std.lv
   .N1                0.823    0.047   17.334      Inf    0.000    0.823
   .N2                0.827    0.045   18.370      Inf    0.000    0.827
   .N3                1.243    0.051   24.148      Inf    0.000    1.243
   .N4                1.712    0.054   31.665      Inf    0.000    1.712
   .N5                1.963    0.056   35.022      Inf    0.000    1.963
    Nfactor           1.650    0.064   25.816      Inf    0.000    1.000
  Std.all
    0.333
    0.355
    0.484
    0.693
    0.749
    1.000</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Correlated_residuals.html" class="pagination-link" aria-label="Correlated residuals">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Correlated residuals</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./summary.html" class="pagination-link" aria-label="Summary">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>